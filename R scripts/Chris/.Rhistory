GMlayout = layout=matrix(-1,10,10)
GMlayout[0,0] = sex
GMlayout[0,1] = age
GMlayout[0,2] = rsbp
GMlayout[1,0] = rdef1
GMlayout[1,1] = rdef2
GMlayout[1,2] = rdef3
GMlayout[1,3] = rdef4
GMlayout[1,4] = rdef5
GMlayout[1,5] = rdef6
GMlayout[1,6] = rdef7
GMlayout[1,7] = rdef8
GMlayout[2,0] = ddiagha
GMlayout[2,1] = ddiagisc
GMlayout[3,0] = TACS
GMlayout[3,1] = PACS
GMlayout[3,2] = POCS
GMlayout[3,3] = LACS
GMlayout[3,4] = OTH
GMlayout[4,0] = rxasp
GMlayout[4,1] = dpe
GMlayout[4,2] = rxhep
GMlayout[5,0] = drsisc
GMlayout[5,1] = drsh
GMlayout[6,0] = ddead
GMlayout[7,0] = occode
GMlayout[9,0] = dnostrk
GMlayout[9,1] = ddiagun
suffStat = list(C = cor(data), n = nrow(data))
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.0005, p=ncol(data),labels =colnames(data), verbose = TRUE)
qgraph(GM,layout = GMlayout)
library("bnlearn")
library("pcalg")
library("qgraph")
data = read.csv("IST_corrected_processed.csv")
rdef1 = 0+1
rdef2 = 1+1
rdef3 = 2  +1
rdef4   =3 +1
rdef5   = 4+1
rdef6   = 5+1
rdef7   =  6+1
rdef8  = 7+1
rxasp   = 8+1
rxhep    = 9+1
ddiagisc  = 10+1
ddiagha  = 11+1
ddiagun  = 12+1
dnostrk   = 13+1
drsisc   = 14+1
drsh    = 15+1
dpe    = 16+1
ddead   = 17+1
age  = 18+1
sex     = 19+1
rsbp    = 20+1
occode   = 21+1
LACS     =  22+1
OTH    = 23+1
PACS   = 24+1
POCS    = 25+1
TACS   = 26+1
GMlayout = layout=matrix(-1,10,10)
GMlayout[0,0] = sex
GMlayout[0,1] = age
GMlayout[0,2] = rsbp
GMlayout[1,0] = rdef1
GMlayout[1,1] = rdef2
GMlayout[1,2] = rdef3
GMlayout[1,3] = rdef4
GMlayout[1,4] = rdef5
GMlayout[1,5] = rdef6
GMlayout[1,6] = rdef7
GMlayout[1,7] = rdef8
GMlayout[2,0] = ddiagha
GMlayout[2,1] = ddiagisc
GMlayout[3,0] = TACS
GMlayout[3,1] = PACS
GMlayout[3,2] = POCS
GMlayout[3,3] = LACS
GMlayout[3,4] = OTH
GMlayout[4,0] = rxasp
GMlayout[4,1] = dpe
GMlayout[4,2] = rxhep
GMlayout[5,0] = drsisc
GMlayout[5,1] = drsh
GMlayout[6,0] = ddead
GMlayout[7,0] = occode
GMlayout[9,0] = dnostrk
GMlayout[9,1] = ddiagun
suffStat = list(C = cor(data), n = nrow(data))
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.0005, p=ncol(data),labels =colnames(data), verbose = TRUE)
qgraph(GM,layout = GMlayout)
View(GMlayout)
View(GMlayout)
GMlayout
library("bnlearn")
library("pcalg")
library("qgraph")
data = read.csv("IST_corrected_processed.csv")
rdef1=0+1
rdef2=1+1
rdef3=2+1
rdef4=3+1
rdef5=4+1
rdef6=5+1
rdef7=6+1
rdef8=7+1
rxasp=8+1
rxhep=9+1
ddiagisc=10+1
ddiagha=11+1
ddiagun=12+1
dnostrk=13+1
drsisc=14+1
drsh=15+1
dpe=16+1
ddead=17+1
age=18+1
sex=19+1
rsbp=20+1
occode=21+1
LACS=22+1
OTH=23+1
PACS=24+1
POCS=25+1
TACS=26+1
GMlayout = layout=matrix(-1,10,10)
GMlayout[1,0] = sex
GMlayout[1,1] = age
GMlayout[1,2] = rsbp
GMlayout[2,0] = rdef1
GMlayout[2,1] = rdef2
GMlayout[2,2] = rdef3
GMlayout[2,3] = rdef4
GMlayout[2,4] = rdef5
GMlayout[2,5] = rdef6
GMlayout[2,6] = rdef7
GMlayout[2,7] = rdef8
GMlayout[3,0] = ddiagha
GMlayout[3,1] = ddiagisc
GMlayout[4,0] = TACS
GMlayout[4,1] = PACS
GMlayout[4,2] = POCS
GMlayout[4,3] = LACS
GMlayout[4,4] = OTH
GMlayout[5,0] = rxasp
GMlayout[5,1] = dpe
GMlayout[5,2] = rxhep
GMlayout[6,0] = drsisc
GMlayout[6,1] = drsh
GMlayout[7,0] = ddead
GMlayout[8,0] = occode
GMlayout[9,0] = dnostrk
GMlayout[9,1] = ddiagun
suffStat = list(C = cor(data), n = nrow(data))
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.0005, p=ncol(data),labels =colnames(data), verbose = TRUE)
qgraph(GM,layout = GMlayout)
GMlayout
GMlayout = layout=matrix(-1,10,10)
GMlayout[1,1] = sex
GMlayout[1,2] = age
GMlayout[1,3] = rsbp
GMlayout[2,1] = rdef1
GMlayout[2,2] = rdef2
GMlayout[2,3] = rdef3
GMlayout[2,4] = rdef4
GMlayout[2,5] = rdef5
GMlayout[2,6] = rdef6
GMlayout[2,7] = rdef7
GMlayout[2,8] = rdef8
GMlayout[3,1] = ddiagha
GMlayout[3,2] = ddiagisc
GMlayout[4,1] = TACS
GMlayout[4,2] = PACS
GMlayout[4,3] = POCS
GMlayout[4,4] = LACS
GMlayout[4,5] = OTH
GMlayout[5,1] = rxasp
GMlayout[5,2] = dpe
GMlayout[5,3] = rxhep
GMlayout[6,1] = drsisc
GMlayout[6,2] = drsh
GMlayout[7,1] = ddead
GMlayout[8,1] = occode
GMlayout
library("bnlearn")
library("pcalg")
library("qgraph")
data = read.csv("IST_corrected_processed.csv")
rdef1=0+1
rdef2=1+1
rdef3=2+1
rdef4=3+1
rdef5=4+1
rdef6=5+1
rdef7=6+1
rdef8=7+1
rxasp=8+1
rxhep=9+1
ddiagisc=10+1
ddiagha=11+1
ddiagun=12+1
dnostrk=13+1
drsisc=14+1
drsh=15+1
dpe=16+1
ddead=17+1
age=18+1
sex=19+1
rsbp=20+1
occode=21+1
LACS=22+1
OTH=23+1
PACS=24+1
POCS=25+1
TACS=26+1
GMlayout = layout=matrix(-1,10,10)
GMlayout[1,1] = sex
GMlayout[1,2] = age
GMlayout[1,3] = rsbp
GMlayout[2,1] = rdef1
GMlayout[2,2] = rdef2
GMlayout[2,3] = rdef3
GMlayout[2,4] = rdef4
GMlayout[2,5] = rdef5
GMlayout[2,6] = rdef6
GMlayout[2,7] = rdef7
GMlayout[2,8] = rdef8
GMlayout[3,1] = ddiagha
GMlayout[3,2] = ddiagisc
GMlayout[4,1] = TACS
GMlayout[4,2] = PACS
GMlayout[4,3] = POCS
GMlayout[4,4] = LACS
GMlayout[4,5] = OTH
GMlayout[5,1] = rxasp
GMlayout[5,2] = dpe
GMlayout[5,3] = rxhep
GMlayout[6,1] = drsisc
GMlayout[6,2] = drsh
GMlayout[7,1] = ddead
GMlayout[8,1] = occode
GMlayout[9,0] = dnostrk
GMlayout[9,1] = ddiagun
suffStat = list(C = cor(data), n = nrow(data))
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.0005, p=ncol(data),labels =colnames(data), verbose = TRUE)
qgraph(GM,layout = GMlayout)
library("bnlearn")
library("pcalg")
library("qgraph")
data = read.csv("IST_corrected_processed.csv")
rdef1=0+1
rdef2=1+1
rdef3=2+1
rdef4=3+1
rdef5=4+1
rdef6=5+1
rdef7=6+1
rdef8=7+1
rxasp=8+1
rxhep=9+1
ddiagisc=10+1
ddiagha=11+1
ddiagun=12+1
dnostrk=13+1
drsisc=14+1
drsh=15+1
dpe=16+1
ddead=17+1
age=18+1
sex=19+1
rsbp=20+1
occode=21+1
LACS=22+1
OTH=23+1
PACS=24+1
POCS=25+1
TACS=26+1
GMlayout = layout=matrix(-1,10,10)
GMlayout[1,1] = sex
GMlayout[1,2] = age
GMlayout[1,3] = rsbp
GMlayout[2,1] = rdef1
GMlayout[2,2] = rdef2
GMlayout[2,3] = rdef3
GMlayout[2,4] = rdef4
GMlayout[2,5] = rdef5
GMlayout[2,6] = rdef6
GMlayout[2,7] = rdef7
GMlayout[2,8] = rdef8
GMlayout[3,1] = ddiagha
GMlayout[3,2] = ddiagisc
GMlayout[4,1] = TACS
GMlayout[4,2] = PACS
GMlayout[4,3] = POCS
GMlayout[4,4] = LACS
GMlayout[4,5] = OTH
GMlayout[5,1] = rxasp
GMlayout[5,2] = dpe
GMlayout[5,3] = rxhep
GMlayout[6,1] = drsisc
GMlayout[6,2] = drsh
GMlayout[7,1] = ddead
GMlayout[8,1] = occode
GMlayout[9,1] = dnostrk
GMlayout[9,2] = ddiagun
suffStat = list(C = cor(data), n = nrow(data))
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.0005, p=ncol(data),labels =colnames(data), verbose = TRUE)
qgraph(GM,layout = GMlayout)
library("bnlearn")
library("pcalg")
library("qgraph")
data = read.csv("IST_corrected_processed.csv")
rdef1=0+1
rdef2=1+1
rdef3=2+1
rdef4=3+1
rdef5=4+1
rdef6=5+1
rdef7=6+1
rdef8=7+1
rxasp=8+1
rxhep=9+1
ddiagisc=10+1
ddiagha=11+1
ddiagun=12+1
dnostrk=13+1
drsisc=14+1
drsh=15+1
dpe=16+1
ddead=17+1
age=18+1
sex=19+1
rsbp=20+1
occode=21+1
LACS=22+1
OTH=23+1
PACS=24+1
POCS=25+1
TACS=26+1
GMlayout = layout=matrix(-1,10,10)
GMlayout[1,1] = sex
GMlayout[1,2] = age
GMlayout[1,3] = rsbp
GMlayout[2,1] = rdef1
GMlayout[2,2] = rdef2
GMlayout[2,3] = rdef3
GMlayout[2,4] = rdef4
GMlayout[2,5] = rdef5
GMlayout[2,6] = rdef6
GMlayout[2,7] = rdef7
GMlayout[2,8] = rdef8
GMlayout[3,1] = ddiagha
GMlayout[3,2] = ddiagisc
GMlayout[4,1] = TACS
GMlayout[4,2] = PACS
GMlayout[4,3] = POCS
GMlayout[4,4] = LACS
GMlayout[4,5] = OTH
GMlayout[5,1] = rxasp
GMlayout[5,2] = dpe
GMlayout[5,3] = rxhep
GMlayout[6,1] = drsisc
GMlayout[6,2] = drsh
GMlayout[7,1] = ddead
GMlayout[8,1] = occode
GMlayout[9,1] = dnostrk
GMlayout[9,2] = ddiagun
suffStat = list(C = cor(data), n = nrow(data))
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.00005, p=ncol(data),labels =colnames(data), verbose = TRUE)
qgraph(GM,layout = GMlayout)
library("bnlearn")
library("pcalg")
library("qgraph")
data = read.csv("IST_corrected_processed.csv")
rdef1=0+1
rdef2=1+1
rdef3=2+1
rdef4=3+1
rdef5=4+1
rdef6=5+1
rdef7=6+1
rdef8=7+1
rxasp=8+1
rxhep=9+1
ddiagisc=10+1
ddiagha=11+1
ddiagun=12+1
dnostrk=13+1
drsisc=14+1
drsh=15+1
dpe=16+1
ddead=17+1
age=18+1
sex=19+1
rsbp=20+1
occode=21+1
LACS=22+1
OTH=23+1
PACS=24+1
POCS=25+1
TACS=26+1
GMlayout = layout=matrix(-1,10,10)
GMlayout[1,1] = sex
GMlayout[1,2] = age
GMlayout[1,3] = rsbp
GMlayout[2,1] = rdef1
GMlayout[2,2] = rdef2
GMlayout[2,3] = rdef3
GMlayout[2,4] = rdef4
GMlayout[2,5] = rdef5
GMlayout[2,6] = rdef6
GMlayout[2,7] = rdef7
GMlayout[2,8] = rdef8
GMlayout[3,1] = ddiagha
GMlayout[3,2] = ddiagisc
GMlayout[4,1] = TACS
GMlayout[4,2] = PACS
GMlayout[4,3] = POCS
GMlayout[4,4] = LACS
GMlayout[4,5] = OTH
GMlayout[5,1] = rxasp
GMlayout[5,2] = dpe
GMlayout[5,3] = rxhep
GMlayout[6,1] = drsisc
GMlayout[6,2] = drsh
GMlayout[7,1] = ddead
GMlayout[8,1] = occode
GMlayout[9,1] = dnostrk
GMlayout[9,2] = ddiagun
suffStat = list(C = cor(data), n = nrow(data))
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.000005, p=ncol(data),labels =colnames(data), verbose = TRUE)
qgraph(GM,layout = GMlayout)
qgraph(GM,layout = GMlayout,curve=10)
qgraph(GM,layout = GMlayout,curve=1000)
qgraph(GM,layout = GMlayout,curve=-1)
qgraph(GM,layout = GMlayout,curve=1,curveall = TRUE)
qgraph(GM,layout = GMlayout,curve=1,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=10,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=3,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=2,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=GMlayout,curveAll = TRUE)
curvelayout = matrix(0,27,27)
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout(1,2) = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout = matrix(0,28,28)
curvelayout(1,2) = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout[1,2] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout = matrix(0,28,28)
#curvelayout[1,2] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout[2,1] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout[2,3] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout = matrix(0,28,28)
curvelayout[2,3] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout = list(0,28)
curvelayout[2] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
curvelayout = list(0,28,28)
curvelayout[2,3] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
matrix
matrix
curvelayout = matrix(0,28,28)
curvelayout[2,3] = 8
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)
GM$nodes
GM.node
GM.nodes
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)$nodes
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)$nodes
qgraph(GM,layout = GMlayout,curve=curvelayout,curveAll = TRUE)$nodeuh
qgraph(GM,layout = GMlayout,curve=2,curveAll = TRUE)
## estimate CPDAG
GM <- pcalg::pc(suffStat,
## independence test: G^2 statistic
indepTest = gaussCItest, alpha = 0.05, p=ncol(data),labels =colnames(data), verbose = TRUE)
curvelayout = matrix(0,28,28)
curvelayout[2,3] = 8
qgraph(GM,layout = GMlayout,curve=2,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=1,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=0,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=0.1,curveAll = TRUE)
qgraph(GM,layout = GMlayout,curve=1,curveAll = TRUE)
